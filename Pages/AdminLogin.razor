@page "/admin/login"
@using Microsoft.AspNetCore.Components
@using Microsoft.JSInterop

<PageTitle>–í—Ö–æ–¥ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å - Marketing Insights</PageTitle>

<div class="admin-login-container">
    <div class="admin-login-card">
        <div class="admin-login-header">
            <h1>üîê –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h1>
            <p>–í–æ–π–¥–∏—Ç–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∞–π—Ç–æ–º</p>
        </div>

        @if (showError)
        {
            <div class="error-message">
                ‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å
            </div>
        }

        <form @onsubmit="HandleLogin" class="admin-login-form">
            <div class="form-group">
                <label for="username">–õ–æ–≥–∏–Ω:</label>
                <input 
                    id="username"
                    type="text" 
                    @bind="username" 
                    @bind:event="oninput"
                    placeholder="–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω"
                    required
                    autocomplete="username"
                />
            </div>

            <div class="form-group">
                <label for="password">–ü–∞—Ä–æ–ª—å:</label>
                <input 
                    id="password"
                    type="password" 
                    @bind="password" 
                    @bind:event="oninput"
                    placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å"
                    required
                    autocomplete="current-password"
                />
            </div>

            <button type="submit" class="login-btn" disabled="@isLoading">
                @if (isLoading)
                {
                    <span>–í—Ö–æ–¥...</span>
                }
                else
                {
                    <span>üöÄ –í–æ–π—Ç–∏</span>
                }
            </button>
        </form>

        <div class="admin-login-footer">
            <small>Marketing Insights - –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º</small>
        </div>
    </div>
</div>

@code {
    private string username = "";
    private string password = "";
    private bool showError = false;
    private bool isLoading = false;

    private async Task HandleLogin()
    {
        isLoading = true;
        showError = false;

        // –ò–º–∏—Ç–∞—Ü–∏—è –∑–∞–¥–µ—Ä–∂–∫–∏ –¥–ª—è UX
        await Task.Delay(500);

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–∏–Ω–∞ –∏ –ø–∞—Ä–æ–ª—è
        if (username == "artem" && password == "qwer1234")
        {
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
            await JS.InvokeVoidAsync("localStorage.setItem", "adminAuthenticated", "true");
            
            // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
            NavigationManager.NavigateTo("/admin/dashboard");
        }
        else
        {
            showError = true;
            password = ""; // –û—á–∏—â–∞–µ–º –ø–∞—Ä–æ–ª—å –ø—Ä–∏ –æ—à–∏–±–∫–µ
        }

        isLoading = false;
    }

    [Inject] private NavigationManager NavigationManager { get; set; } = default!;
    [Inject] private IJSRuntime JS { get; set; } = default!;
}
